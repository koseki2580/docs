---
title: OSPF
sidebar_label: OSPF
draft: true
toc_max_heading_level: 5
tags: [ネットワーク]
---

```mdx-code-block
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FontColor from "@site/src/components/Custom/FontColor"
import SplitParagraph from "@site/src/components/Custom/SplitParagraph"
import Paragraph from "@site/src/components/Custom/Paragraph"

```

## OSPF とは

OSPF は、Interior Gateway Protocol（IGP）として分類され、IP パケットヘッダーにある宛先 IP アドレスのみに基づいて IP パケットをルーティングする。
OSPF プロトコルは、リンクステートまたは SPF 技術に基づいている。

リンクステートルーティングプロトコルでは、各ルーターは AS のトポロジを説明するデータベースを持ち、リンク状態データベースと呼ばれる。

AS のリンク状態データベースは、有向グラフを記述する。グラフの頂点は、ルーターとネットワークで構成される。グラフ辺(エッジ)は、物理的なポイントツーポイントネットワークを介して接続されている 2 つのルーターを接続し、ルーターをネットワークに接続するエッジは、ルーターがネットワーク上にインターフェイスを持っていることを意味する。

ネットワークは、2 種類のネットワークが存在する。

- トランジットネットワーク
  - ローカルで発信されたものでもローカルで送信されたものでもないデータトラフィックを伝送できるネットワークであり、入力エッジと出力エッジの両方を持つグラフ頂点で表す。
- スタブネットワーク
  - 頂点には入力エッジのみ

OSPF では、隣接するネットワークとホストのコレクションをグループ化でき、グループは、含まれているネットワークのいずれか 1 つへのインターフェースを持つルーターと合わせて、エリアと呼ばれる。各エリアには独自のリンクステートデータベースと対応するグラフが存在する。複数のエリアに接続されているルーターは、`エリア境界ルーター`と呼ばれる。

エリアのトポロジは、エリアの外側からは見えず、特定のエリアの内部にあるルーターは、そのエリアの外部にある詳細なトポロジについては何も知らない。このような分離により、AS 全体を単一のリンクステートドメインとして扱う場合と比較して、プロトコルはルーティングトラフィックを大幅に削減できる。

AS でのルーティングは、パケットの送信元と宛先が同じエリア(エリア内ルーティング)にあるか、異なるエリア(エリア間ルーティング)にあるかに応じて行われる。エリア内ルーティングでは、パケットはエリア内で取得された情報のみに基づいてルーティングされ、エリア外から取得した経路情報は使用できない。これにより、エリア内ルーティングが不正なルーティング情報の挿入から保護される。

OSPF バックボーンは特別な OSPF エリア 0 であり、常にすべてのエリア境界ルーターが含まれている。バックボーンは、非バックボーンエリア間でルーティング情報を配信する役割を果たすため、バックボーンは隣接している必要がある。ただし、物理的に隣接している必要はない。

2 つの非バックボーンエリア間でパケットをルーティングする場合、バックボーンが使用される。パケットが移動するパスは、3 つの連続した部分に分割でき、

- 送信元からエリア境界ルーターへのエリア内パス
- 送信元と宛先エリア間のバックボーンパス
- 宛先の別のエリア内パス

エリア間ルーティングは、AS 上でバックボーンをハブとして、非バックボーンエリアのそれぞれをスポークとしたスター構成と考えることもできる。

AS が OSPF エリアに分割されると、ルーターは機能に従ってさらに次の 4 つに分割される。

- 内部ルーター
  - 同じエリアに属する直接接続されたルータ
- エリア境界ルーター
  - 複数のエリアに接続するルーター。接続されたエリアのトポロジー情報を凝縮して、バックボーンに送信する。
- バックボーンルーター
  - バックボーンエリアへのインターフェイスを持つルーター。複数のエリアにインターフェースするすべてのルーターが含まれる。
- AS 境界ルーター
  - 他の AS に属するルーターとルーティング情報を交換するルーター。AS 全体で AS 外部ルーティング情報を送信する。

## 参考

[rfc2328]: https://www.rfc-editor.org/rfc/rfc2328.html
