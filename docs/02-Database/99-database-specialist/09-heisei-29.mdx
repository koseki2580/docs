---
title: 平成29年
sidebar_label: 平成29年
draft: true
toc_max_heading_level: 5
tags: [データベース, 資格, データベーススペシャリスト, 午後1, 午後2]
---

```mdx-code-block
import UnderLine from "@site/src/components/Custom/UnderLine"
import FontColor from "@site/src/components/Custom/FontColor"

```

:::caution 注意事項
一個人の解答からここが根拠だろうという部分を取り出してまとめたものになります。
:::
以下の写真は全て実際の問題よりスクリーンショットで取得したものを表示させています。
また、「」内の文字は問題からそのまま引用しています。

## 午後 1

出典 : 平成 29 年度 春期 データベーススペシャリスト試験　午後 1

[問題](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2017h29_1/2017h29h_db_pm1_qs.pdf)

[解答](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2017h29_1/2017h29h_db_pm1_ans.pdf)

問題と解答は上記からダウンロードすることができます。

解答作成中

## 午後 2

出典 : 平成 29 年度 春期 データベーススペシャリスト試験　午後 2

[問題](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2017h29_1/2017h29h_db_pm2_qs.pdf)

[解答](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2017h29_1/2017h29h_db_pm2_ans.pdf)

問題と解答は上記からダウンロードすることができます。

### 大問 1

#### 設問 1

##### (1)

- $\textcircled{\scriptsize 1}$

  ページ 6 $\sim$ ページ 7 にかけて「 $\sim$ 使用したポイントは、即座に使用可能ポイントから差し引かれる。」と書かれている。
  また、ページ 8 $>$ (2) $>$ $\textcircled{\scriptsize 4}$に　
  「ポイント統合は申請の翌日以降に有効となり、店舗販売と OL 販売のどちらでもポイントを使用できるようにする。」と書かれている。
  さらに、ページ 11 $\sim$ ページ 12 にかけて「 $\sim$ 店舗販売システムと OL 販売システムの間で直接データ交換を行うのではなく、連携システムに、両システムのデータを一部を統合、
  一部を複製した上で、連携システムを介して双方の情報連携を行う。」と書かれているので、ポイント統合が行われている場合、
  店舗販売システムでポイントが使用された場合は OL 販売システムの使用可能ポイントが同期されていないと不正にポイントが使用される場合があるので、

  `ポイント統合後の会員が購入時にポイントを使用した場合`

  となる。

- $\textcircled{\scriptsize 2}$

  ロールバックを行う必要があるのでデータを追加・更新・削除を行なっていた場合なので、会員テーブルを追加・参照・削除行なっている

  `会員登録, POS入力, ポイント反映`

  となる。

##### (2)

![午後2 設問1 表5](/img/png/Database/database-specialist/H29/2-1-chart-5.png "午後2 設問1 表5")

- a

  ページ 8 $>$ (1) $>$ $\textcircled{\scriptsize 1}$に
  「店舗販売業務と OL 販売業務を統括する販売統括部を新設し、両業務に共通する商品情報及びそれに関連する商品分類情報を管理する。」と記載されており、
  店舗販売システムと OL 販売システムでは情報を共有していないが、情報共有対象のテーブルに小分類コードが存在するので情報共有テーブルから参照されるので
  (ⅱ), (ⅲ)の連携 AP となるので

  配置方法$\textcircled{\scriptsize 2}$

  となる。

- b

  a と同じで分類コードは情報共有対象テーブルから参照されているかつ、販売統括部の管理下なので、

  配置方法$\textcircled{\scriptsize 2}$

  となる。

- c

  店舗販売システムでしか使用しないテーブルで情報共有対象テーブルからも参照されていないので、
  (ⅰ), (ⅱ)ともに満たさないから

  配置方法$\textcircled{\scriptsize 1}$

  となる。

- d

  店舗販売システムと OL 販売システムともに倉庫在庫テーブルが存在し、CRUD をみると参照・追加・更新が行われているので(ⅰ)を満たす。
  (ⅲ)は現行システムで追加・更新が行われるので、現行 AP となる。
  また、ページ 9 $>$ (3) $>$ $\textcircled{\scriptsize 1}$に
  「全エリアの倉庫からの配送を可能にして、店舗販売業務の取扱商品の多くを OL 販売で取り扱えるようにする」、
  $\textcircled{\scriptsize 2}$に
  「エリアの倉庫在庫から他エリアの店舗へ出荷できるようにする。」とあるので、両システムで同期をとる必要があることが分かるので、(ⅳ)では同期が必要となる。
  店舗販売システムでは倉庫コードと商品コードが主キーとなっているが、OL 販売システムでは商品コードのみが主キーとなっているので、
  商品コードが同じで倉庫コードが違うという更新があった場合に主キーが等しい行に対する更新が同時に発生するので、

  配置方法$\textcircled{\scriptsize 5}$

  となる。

- e

  店舗販売システムでしか使用しないテーブルで情報共有対象テーブルからも参照されていないので、

  (ⅰ), (ⅱ)ともに満たさないから

  配置方法$\textcircled{\scriptsize 1}$

  となる。

#### 設問 2

##### (1)

![午後2 設問1 図3](/img/png/Database/database-specialist/H29/2-1-figure-3.png "午後2 設問1 図3")

ページ 8 $>$ (2) $>$ $\textcircled{\scriptsize 2}$に
「会員から申請があれば、ポイント統合を行う。統合後は、OL 販売の会員番号を正規の会員番号とし、ポイントを集約する。」とあるので、
集約先の会員番号をもつ必要があることが分かる。

ページ 8 $>$ (2) $>$ $\textcircled{\scriptsize 3}$に
「会員は、統合するポイントカードの店舗コードと店舗会員番号を指定する。複数のポイントカードのうち、1 枚だけを存続させ、その他は廃止する。」とあるので、
廃止された会員番号かどうかを判断する必要があるので`廃止区分`属性が必要であることが分かる。

ページ 8 $>$ (2) $>$ $\textcircled{\scriptsize 4}$に
「 $\sim$ ポイント統合の対象となったポイントカードの統合申請日、統合対象ポイント(統合時点の使用可能ポイント)を記録し、 $\sim$ 」とあるので、
ポイントカードの統合申請日と統合対象ポイントを持つ必要があることが分かる。

まとめると、

| 列名             | 列値の内容                         |
| ---------------- | ---------------------------------- |
| 廃止区分         | ポイントカードの廃止有無を表す値   |
| 統合先会員番号   | ポイント統合後の統合先の会員番号   |
| 統合申請日       | ポイント統合の申請日               |
| 統合対象ポイント | ポイント統合時点の使用可能ポイント |

となる。

制約については、統合区分が統合済みである場合は既に統合されているはずなので統合先会員番号は NULL ではないということが分かる。
また、統合されるのは会員区分が店舗会員だけであるので、

`会員区分が店舗会員かつ統合区分が統合済みの場合、統合先会員番号はNULLでない`

となる。

##### (2)

![午後2 設問1 図4](/img/png/Database/database-specialist/H29/2-1-figure-4.png "午後2 設問1 図4")
![午後2 設問1 図5](/img/png/Database/database-specialist/H29/2-1-figure-5.png "午後2 設問1 図5")

- 権限の付与先

  ページ 15 $>$ 2. 会員の個人情報漏えい防止対策 $>$ $\textcircled{\scriptsize 1}$, $\textcircled{\scriptsize 2}$に　
  「会員番号、氏名、ポイントは全従業員に全会員の情報参照を許す。それ以外の情報(以下、機密情報という)の参照は、必要とする特定の役職及び特定の担当職務の従業員に限定する。」,
  「機密情報の参照が認められた従業員であっても、参照できるのは従業員が所属する店舗の登録会員の情報だけに限定する。」とある。
  また、ページ 12 $>$ 1, 権限 $>$ (3)に「テーブル、ビューのアクセス権限は、ユーザ ID, ロールに付与される。ロールは、ユーザ ID 及び他のロールに付与される。」とあるので
  会員ビュー V1 は会員番号, 氏名, ポイントを取得していることから

  `全従業員のユーザID`

  となる。

  会員ビュー V2 は機密情報となり、ページ 16 $>$ (2) $>$ $\textcircled{\scriptsize 4}$に
  「 $\sim$ 機密情報へのアクセス制御には、認可役職ロール、認可担当職務ロールを用いる。」とあるので、

  `認可役職ロール及び認可担当職務ロール`

  となる。

- g

  ページ 16 $>$ (2) $>$ $\textcircled{\scriptsize 5}$に
  「図 5 の SQL 文で作成したビューでは、従業員が所属する店舗の会員情報だけにアクセスを限定する。ただし、ポイント統合後の店舗会員については、統合先の OL 会員情報も参照可能とする。」とあるので、
  所属する店舗の会員情報と統合先の会員情報の 2 種類を SQL 文を考える必要があることがわかり、図 5 には UNION 句で 2 つの SQL を合わせている。
  初めの SELECT 文の方がシンプルに記述されているので所属する店舗の会員情報の部分であることが分かる。

  接続した従業員の情報が必要になるので

  `従業員`

  となる。

- h

  接続に用いられたユーザ ID は`CURRENT_USER`で分かるので、CURRENT_USER と従業員テーブルの従業員 ID を突き合わせることで特定の従業員の情報を取得することが可能であり、
  従業員テーブルには所属する店舗の情報が記載されているので、

  ```sql
  SELECT A.* FROM 会員 A INNER JOIN 従業員 B ON A.店舗コード = B.店舗コード AND B.従業員ID = CURRENT_USER
  ```

  となることから

  `A.店舗コード = B.店舗コード AND B.従業員ID = CURRENT_USER`

  となる

- i

  会員と会員とで内部結合しているので、統合先の会員情報を取得するために結合していると分かるので、

  `A.会員番号 = B.統合先会員番号`

  となる。

- j

  h と同じで同じ店舗の情報を見ることができるようにするので、

  `C.店舗コード = B.店舗コード AND C.従業員 = CURRENT_USER`

  となる。

  ※A.店舗コード ではなく B.店舗コードとなるのは、所属している店舗会員の統合先の会員情報を参照可能であるからである。

##### (3)

- 日締処理で行う操作

  ページ 16 $>$ 3. 販売分析データの作成(バッチ処理)に
  「 $\sim$ 店舗販売業務、OL 販売業務では、それぞれ、その日のうちに日締めを行なっているが、日締時刻は日によって異なり、順序も決まっていない。 $\sim$ 」
  とあるので、どちらが先に実行されても問題ないような処理が行われていることがわかる。
  また、ページ 17 の図 6 を見ると、

  ![午後2 設問1 図6](/img/png/Database/database-specialist/H29/2-1-figure-6.png "午後2 設問1 図6")

  主キーに処理年月日となっているのでデータの挿入 1 度しか行われないことも分かる。さらに、テーブルが存在している場合はもう一方の日締処理は行われていることが分かる。

  これらをまとめて考えると

  `行がなければ対応するフラグを完了、他方を未完了として行を追加し、行があれば対応するフラグを完了にして更新する`

  となる。

- トリガの定義内容

  トリガで行われる内容は ページ 16 $>$ 3. 販売分析データの作成(バッチ処理)に
  「 $\sim$ バッチ処理中の元データ更新を避けるため、両業務とも日締めが完了したときに、該当テーブルのレプリケーションを自動的に無効化する。 $\sim$ 」
  と書かれている。

  - $\textcircled{\scriptsize 1}$

    ページ 12 $>$ 2. トリガに「テーブルに対する操作(追加・更新)を契機に、あらかじめ定義された処理を実行する。実行タイミング(追加・更新の前又は後)、列値による実行条件を定義することができる。」
    とあるので、

    `更新`

    となる。

  - $\textcircled{\scriptsize 2}$

    実行条件は上記に書かれているとおりに

    `店舗日締フラグとOL日締フラグが共に完了であること`

    となる。

  - $\textcircled{\scriptsize 3}$

    行われる処理も上記に書かれているとおりに

    `レプリケーションを無効化する`

    となる。

#### 設問 3

##### (1)

![午後2 設問1 表1](/img/png/Database/database-specialist/H29/2-1-chart-1.png "午後2 設問1 表1")

- 追加するテーブル

  ページ 9 $>$ (4) $>$ $\textcircled{\scriptsize 2}$に　
  「会員の性別、居住地域(関東、東海など)、年齢層(10 代、20 代など)を用いて分析を行う。」と書かれているが、テーブルに会員の情報が何もないので、会員についてテーブルを追加することがわかる。
  店舗軸・商品軸のように書かれているので会員軸というテーブル名になることがわかり、主キーは会員軸 ID となる。属性については、分析を行うものについて列挙されているので、
  性別、居住地域、年齢層であることが分かるので、まとめると

  > 会員軸 : <UnderLine>会員軸 ID</UnderLine>, 性別, 居住地域, 年齢層

- k

  販売ファクトテーブルにはそれぞれの軸の ID が外部キーとして設定されているので、追加した会員軸を外部キーとして設定する必要があるので、

  `会員軸ID`

  となる。

- l

  ページ 9 $>$ (4) $>$ $\textcircled{\scriptsize 1}$に
  「店舗販売と OL 販売をチャネル区分で識別し、チャネル横断的に販売分析処理を行えるようにする。」と書かれているので、

  `チャネル区分`

  となる。

- m

  ページ 9 $>$ 表 1 $>$ 処理例 1 に「OL 販売業務で用いている商品分類を第 1 $\sim$ 3 階層の範囲内から選択し、 $\sim$ 」とあり、問題文には
  「〔販売業務改善の要件〕に従って、表 1 の販売分析処理が可能となるように、 $\sim$ 」とあるので、

  `分類コード1`, `分類コード2`, `分類コード3`

  となる。

##### (2)

- ア

  ページ 9 $>$ 表 1 $>$ 処理例 2 に「 $\sim$ 関東地域に居住する 30 代の女性が購入した $\sim$ 」とあるので、会員軸で結合を行うことが分かるので

  `会員軸`

  となる

- イ

  $\textcircled{\scriptsize 2}$を参考にして書くと、

  `会員軸IDで等結合し、性別が女性、かつ、年齢層が30代、かつ、居住地域が関東地域と一致する行を選択`

  となる。

- ウ

  ページ 9 $>$ 表 1 $>$ 処理例 2 に「 $\sim$ 店舗販売の大分類コードが'K001'(キッチン用品)の件数を $\sim$ 」とあるので

  `商品軸`

  となる。

- エ

  $\textcircled{\scriptsize 2}$を参考にして書くと、

  `商品軸IDで等結合し、大分類コードが'K001'と一致する行を選択`

  となる。

### 大問 2

#### 設問 1

関係スキーマから解答する

##### (2)

![午後2 設問2 図4](/img/png/Database/database-specialist/H29/2-2-figure-4.png "午後2 設問2 図4")

- a

  ページ 21 $>$ 1. 自社組織・得意先・商品 $>$ (1) $>$ $\textcircled{\scriptsize 1}$に
  「拠点の種類は拠点種類区分で分類している。拠点は拠点コードで識別し、拠点名を保持している。」と書かれているので

  > 拠点名, 拠点種類区分

  となる。

- b

  ページ 21 $>$ 1. 自社組織・得意先・商品 $>$ (1) $>$ $\textcircled{\scriptsize 3}$に
  「本社には、幾つかの販売部がある。販売部と営業所を合わせて営業部門と呼び、営業部門コードで識別している。 $\sim$ 」とあり、
  営業部門のサブタイプとなることが分かる。営業所にはすでに主キーとして拠点コードが設定されており、営業部門コードも主キーとして
  設定してしまうと複数の拠点に複数の営業所が存在することになり、拠点名と営業所の 1 対 1 の関係が成り立たなくなるので、外部キーとして持つことがわかる。
  また、図 3 の E-R 図を見ると物流センターから矢印が出ているので、

  > <UnderLine style="dotted">
  >   営業所営業部門コード
  > </UnderLine>, <UnderLine style="dotted">物流センタ拠点コード</UnderLine>

  となる。

- c

  ページ 21 $>$ 1. 自社組織・得意先・商品 $>$ (1) $>$ $\textcircled{\scriptsize 3}$に
  「 $\sim$ 営業部門が、販売部と営業所のどちらに該当するかは、営業部門区分で分類している。」とあるので、

  > 営業部門区分

  となる。

- d

  ページ 21 $>$ 1. 自社組織・得意先・商品 $>$ (2) $>$ $\textcircled{\scriptsize 2}$に
  「 $\sim$ 得意先が請求得意先に該当するか否かは、請求得意先フラグで識別する。請求得意先は、請求書を集約する対象の得意先をもつ。」とあり、
  得意先は請求得意先のスーパタイプであることが分かる。請求得意先のテーブルを見ると集約先の得意先を持つと書かれているのにも関わらず、テーブルに定義されていないので、
  スーパタイプの得意先で持つことが分かる。

  ページ 22 $>$ $\textcircled{\scriptsize 3}$に
  「得意先には、地域得意先と広域得意先があり、得意先区分で分類している。 $\sim$ 」とあるので、　
  地域得意先と広域得意先のスープタイプであることが分かる。
  まとめると、

  > 得意先区分, 請求得意先フラグ, <UnderLine style="dotted">請求得意先コード</UnderLine>

  となる。

- e

  ページ 22 $>$ $\textcircled{\scriptsize 3}$に
  「 $\sim$ 広域得意先に対する営業は、いずれかの販売部が担当する。 $\sim$」とあるので、担当販売部の情報を持つことが分かる。

  ページ 22 $>$ $\textcircled{\scriptsize 4}$に
  「 $\sim$ まとめて発注される各広域得意先は、どの発注得意先から発注されるか決められている。」とあるが、発注得意先テーブルは発注得意先についての項目を定義していないので、
  スーパタイプである広域得意先で持つことが分かる。
  まとめると、

  > <UnderLine style="dotted">
  >   発注得意先コード
  > </UnderLine>, <UnderLine style="dotted">担当販売部営業部門コード</UnderLine>

  となる。

- f

  ページ 22 $>$ (3) $>$ $\textcircled{\scriptsize 3}$に
  「商品ごとに生産する工場を決めており、生産する工場の拠点コードと生産ロットサイズを設定している。」とあるので、

  > <UnderLine style="dotted">生産工場拠点コード</UnderLine>

  となる。

- g

  ページ 23 $>$ (3) $>$ $\textcircled{\scriptsize 1}$に
  「在庫には、基準在庫数量と補充ロットサイズを設定している。」とあり、
  基準在庫数量と補充ロットサイズを持つことが分かる。

  また、ページ 23 $>$ (3) $>$ $\textcircled{\scriptsize 2}$に
  「実在庫数量が基準在庫数量を下回った商品を対象に、1 日に 1 回、下位拠点から上位拠点に対してい商品の要求(以下、補充要求)を行い、 $\sim$ 」とあるので、
  実在庫数量を持つ必要があることが分かる。

  さらに、ページ 23 $>$ (6) $>$ $\textcircled{\scriptsize 2}$に
  「在庫引当ができた要求は、その要求分が出庫されるまで引当済数量に累積する。」とあるので、
  引当済数量も持つ必要があることが分かる。

  まとめると、

  > 基準在庫数量, 補充ロットサイズ, 実在庫数量, 引当済数量

  となる。

- h

  ページ 25 $>$ $\textcircled{\scriptsize 5}$に
  「注文の記録は、地域得意先納入と同じである。」と書かれており、ページ 25 $>$ $\textcircled{\scriptsize 4}$に
  「注文では、注文年月日、納入先の得意先、注文を受けた商品・数量を記録する。」と書かれているので、

  > <UnderLine style="dotted">広域得意先コード</UnderLine>

  となる。

- i

  ページ 25 $>$ $\textcircled{\scriptsize 5}$に
  「納入指示では、地域得意先納入の記録の他に、納入する物流センタを記録する。」とあり、
  地域地域得意先納入指示(納入指示)のサブタイプであることが分かる。また、物流センタを追加で記録されているので、

  > <UnderLine style="dotted">納入元物流センタ拠点コード</UnderLine>

  となる。

- j

  ページ 25 $>$ $\textcircled{\scriptsize 3}$に
  「補充要求では、要求年月日、要求元の拠点、要求した商品・数量を記録する。」とあり、
  ページ 23 $>$ (3) $>$ $\textcircled{\scriptsize 2}$に
  「実在庫数量が基準在庫数量を下回った商品を対象に、1 日 1 回、下位拠点から上位拠点に対して商品の要求(以下、補充要求という)を行い、上位拠点から下位拠点に商品が補充される。」
  と書かれているので、要求した商品・数量は複数存在することが分かるので、補充要求明細テーブルが必要となる。
  補充要求と補充要求明細には要求元の拠点が書かれていないので、

  > <UnderLine style="dotted">要求元営業所拠点コード</UnderLine>

  となる。

- k

  ページ 24 $\sim$ 25 $>$ $\textcircled{\scriptsize 2}$に
  「生産では、生産年月日、生産した商品、生産数量、生産した商品の入庫先物流センタを記録する。」と書かれているので、

  > <UnderLine style="dotted">入庫先物流センタ拠点コード</UnderLine>

  となる。

##### (1)

![午後2 設問2 図3](/img/png/Database/database-specialist/H29/2-2-figure-3.png "午後2 設問2 図3")

- 拠点
