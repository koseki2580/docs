---
title: 平成28年
sidebar_label: 平成28年
draft: true
toc_max_heading_level: 5
tags: [データベース, 資格, データベーススペシャリスト, 午後1, 午後2]
---

```mdx-code-block
import UnderLine from "@site/src/components/Custom/UnderLine"
import FontColor from "@site/src/components/Custom/FontColor"

```

:::caution 注意事項
一個人の解答からここが根拠だろうという部分を取り出してまとめたものになります。
:::
以下の写真は全て実際の問題よりスクリーンショットで取得したものを表示させています。
また、「」内の文字は問題からそのまま引用しています。

## 午後 1

出典 : 平成 28 年度 春期 データベーススペシャリスト試験　午後 1

[問題](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2016h28_1/2016h28h_db_pm1_qs.pdf)

[解答](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2016h28_1/2016h28h_db_pm1_ans.pdf)

問題と解答は上記からダウンロードすることができます。

解答作成中

## 午後 2

出典 : 平成 28 年度 春期 データベーススペシャリスト試験　午後 2

[問題](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2016h28_1/2016h28h_db_pm2_qs.pdf)

[解答](https://www.jitec.ipa.go.jp/1_04hanni_sukiru/mondai_kaitou_2016h28_1/2016h28h_db_pm2_ans.pdf)

問題と解答は上記からダウンロードすることができます。

### 大問 1

#### 設問 1

##### (1)

![午後2 大問1 表4](/img/png/Database/database-specialist/H28/2-1-chart-4.png "午後2 大問1 表4")

![午後2 大問1 表1](/img/png/Database/database-specialist/H28/2-1-chart-1.png "午後2 大問1 表1")

![午後2 大問1 表2](/img/png/Database/database-specialist/H28/2-1-chart-2.png "午後2 大問1 表2")

**前提条件**

ページ 11 $>$ 1, テーブル定義 $>$ (1) $>$ $\textcircled{\scriptsize 4}$に「日付、時刻、時刻印の列は、専用のデータ型を選択する。」と書かれているので、
`日付`, `時刻`, `時刻印`の列にはそれぞれに対応する専用の型を適応する。

ページ 11 $>$ 1. テーブル定義 $>$ (1) $>$ $\textcircled{\scriptsize 2}$, $\textcircled{\scriptsize 3}$に
「数値の列が整数である場合は、取り得る値の範囲に応じて、SMALLINT 又は INTEGER を選択する。それ以外の場合は DECIMAL を選択する。」、
「$\textcircled{\scriptsize 1}$及び$\textcircled{\scriptsize 2}$どちらの場合も、列の取り得る値の範囲に従って、格納領域の長さが最小となるようにデータ型を選択する。」
と書かれているので、データ型は格納領域が最小となるように選択する。

ページ 10 $>$ (1)に「 $\sim$ NOT NULL 制約を指定しない列には、NULL かどうかを表す 1 バイトのフラグが付加される。」と書かれているので、
NOT NULL 制約が`Y`であれば 0 バイト、`N`であれば 1 バイトとして扱う。

ページ 11 $>$ 1, テーブル定義 $>$ (4) $>$ $\textcircled{\scriptsize 1}$, $\textcircled{\scriptsize 2}$に
索引の種類には、P(主キーの索引)、U(ユニーク索引), NU(非ユニーク索引)がある。」、「主キーの索引は、必ず作成する。」
と書かれているので、主キーには必ず索引を作成する。

ページ 11 $>$ 1, テーブル定義 $>$ (4) $>$ $\textcircled{\scriptsize 3}$に
「主キー以外で値が一意となる列又は列の組合せには、必ずユニーク索引を作成する。それ以外の列又は列の組合せが、外部キーを構成する場合は、必ず非ユニーク索引を作成する。」
と書かれているので、一意になる項目かどうかでユニーク索引を、外部キーかどうかで非ユニーク索引を作成する。

**<FontColor color="red">以下のように定義されているのに、構成列の決め方については一切記述がないので構成順の決め方は正しくない可能性があります。</FontColor>**
ページ 11 $>$ 1, テーブル定義 $>$ (4) $>$ $\textcircled{\scriptsize 4}$に
「各索引の構成列には、構成列の定義順に 1 からの連番を記入する。」
と書かれているので、構成列の番号は構成列の定義順に決めていく。

- 行員番号

  行員番号は主キーであるため、索引の種類と構成列に`P`を追加する。
  また、関係スキーマをみると構成列として一番前に存在するので、番号を`1`とする。

- 予定日

  主キーとなっており、また、構成列が 2 番目であるので、索引の種類と構成列の P 行が`2`となる。

- 開始時刻

  - データ型

    表 1 より時刻を扱っていることが分かるので、データ型は`TIME`となる。

  - NOT NULL

    主キーは NOT NULL 制約が存在するので NOT NULL は`Y`となる。

  - 格納長

    TIME 型は 3 バイトであり、NOT NULL 制約を指定するので、合わせて`3 + 0 = 3`バイトとなる。

  - 索引の種類と構成列

    主キーであり、構成列が前から 3 番目となっているので、索引の種類と構成列の P 行が`3`となる。

- 行番号

  - データ型

    表 1 を見ると行番号は 1 $\sim$ 999 番までしか取らないことが分かるので、SMALLINT で数値の範囲が収まるので、`SMALLINT`となる。

  - NOT NULL

    主キーは NOT NULL 制約が存在するので NOT NULL は`Y`となる。

  - 格納長

    SMALLINT は 2 バイトであり、NOT NULL 制約を指定するので、`2 + 0 = 2`バイトとなる。

  - 索引の種類と構成列

    主キーであり、構成列が前から 4 番目となっているので、索引の種類と構成列の P 行が`4`となる。

- 終了時刻

  - データ型

    表 1 より時刻を扱っていることが分かるので、データ型は`TIME`となる。

  - NOT NULL

    表 1 に「 $\sim$ "スケジュール"テーブルの場合は必須で、 $\sim$ 」と書かれているので、`Y`となる。

  - 格納長

    TIME 型は 3 バイトであり、NOT NULL 制約を指定するので、合わせて`3 + 0 = 3`バイトとなる。

  - 索引の種類と構成列

    主キーでも、一意に決まる項目でも、外部キーでもないので索引は特になし

- 行動種別

  - データ型

    表 1 を見ると 1 $\sim$ 5 の数字を''で囲われているので、文字列であることが分かるので、1 $\sim$ 5 を格納するための文字列の大きさは`CHAR(1)`で十分である。

  - NOT NULL

    表 1 に「 $\sim$ のいずれか」と書かれているので、`Y`となる。

  - 格納長

    CHAR 型は文字数でバイト数が決まり、今回は 1 文字で、NOT NULL 制約を指定するので、`1 + 0 = 1`バイトとなる。

  - 索引の種類と構成列

    主キーでも、一意に決まる項目でも、外部キーでもないので索引は特になし

- 行動内容

  - データ型

    表 1 を見ると全角文字であり、最大 1000 文字であることが分かるので、`NCHAR VARYING(1000)`となる。

  - NOT NULL

    表 1 に「 $\sim$ "スケジュール"テーブルの場合は任意である。」とあるので、`N`となる。

  - 格納長

    ページ 11 $>$ 1. テーブル定義 $>$ (3)に
    「 $\sim$ 可変長文字列の格納長は、表 1 から平均文字数が分かる場合はそれを基準に算出し、それ以外の場合は最大文字数の半分を基準に算出する。」
    と書かれており、表 1 には「平均文字数は 58 文字」と書かれている。`NCHAR VARYING`のバイト数は文字数*2 バイト + 制御情報の 4 バイトであり、
    NOT NULL 制約を指定しないので`58 * 2 + 4 + 1 = 121`バイトとなる。

  - 索引の種類と構成列

    主キーでも、一意に決まる項目でも、外部キーでもないので索引は特になし

- 支店コード

  - データ型

    表 1 に「4 桁の半角英数字」と書かれているので`CHAR(4)`となる。

  - NOT NULL

    表 1 の案件番号の欄を見ると「 $\sim$ "スケジュール"テーブルの支店コードと案件番号は、案件に関連する顧客との面談予定などを登録する場合にだけ設定する」
    と書かれているので、`N`となる。

  - 格納長

    CHAR 型は文字数でバイト数が決まり、今回は 4 文字で、NOT NULL 制約を指定しないので、`4 + 1 = 5`バイトとなる。

  - 索引の種類と構成列

    外部キーとなっているので、`NU`の索引を作成する必要がある。
    案件テーブルの主キーの一番前が支店コードとなっているため、構成順は`1`となる。

- 案件番号

  - データ型

    表 1 に「(1 $\sim$ 99,999,999)」と書かれており、この範囲に収まる数値は`INTEGER`型となる。

  - NOT NULL

    支店コードと同様で`N`となる。

  - 格納長

  INTEGER 型は 4 バイトであり、NOT NULL 制約を指定しないので、`4 + 1 = 5`バイトとなる。

  - 索引の種類と構成列

    外部キーであるので`NU`となり、案件テーブルの 2 番目に書かれていることから構成順は`2`となる。

まとめると、

|    列名    |      データ型       | NOT<br/>NULL | 格納長<br/>(バイト) | 索引の種類と構成列<br/>1 | <br/>2 | <br/>3 |
| :--------: | :-----------------: | :----------: | :-----------------: | :----------------------: | :----: | :----: |
|    ---     |         ---         |     ---      |         ---         |            P             |   NU   |        |
|  行員番号  |         ---         |     ---      |         ---         |            1             |        |        |
|   予定日   |         ---         |     ---      |         ---         |            2             |        |        |
|  開始時刻  |        TIME         |      Y       |          3          |            3             |        |        |
|   行番号   |      SMALLINT       |      Y       |          2          |            4             |        |        |
|  終了時刻  |        TIME         |      Y       |          3          |                          |        |        |
|  行動種別  |       CHAR(1)       |      Y       |          1          |                          |        |        |
|  行動内容  | NCHAR VARYING(1000) |      N       |         121         |                          |        |        |
| 支店コード |       CHAR(4)       |      N       |          5          |                          |   1    |        |
|  案件番号  |       INTEGER       |      N       |          5          |                          |   2    |        |

- a

  支店コードと案件番号を主キーとして持っているテーブルが案件テーブルであるので、外部キーは案件テーブルを指していることが分かるので、

  ```sql
  FOREIGN KEY (支店コード, 案件番号) REFERENCES 案件 (支店コード, 案件番号)
  ```

  となる。

- b

  表 1 の開始時刻の欄を見ると「終了時刻は開始時刻よりも後でなければならない」と書かれているので、

  ```sql
  CHECK 開始時刻 < 終了時刻
  ```

  となる。

- c

  表 1 の行動種別の欄を見ると「 $\sim$ のいずれか」と書かれているので、表に書かれているものだけしか入力しないことが分かるので、

  ```sql
  CHECK 行動種別 IN ('1', '2', '3', '4', '5')
  ```

  となる。

##### (2)

- d

  スケジュールテーブルの格納長を全て足し合わせるだけで良いので`4 + 4 + 3 + 2 + 3 + 1 + 121 + 5 + 5 = 148`バイトとなる。

- e

  問題文に「空き領域率は 10 $%$ とする。」と書かれているので、最大で使用できるページサイズは`4,000 * 0.9 = 3,600`バイトとなる。
  1 データページ当たりの平均行数なので、1 行で格納される 148 バイトで割ることで 1 ページ当たりの平均行数を求めることができるので、
  `3,600 / 148 = 24.32`となるので、`24`行となる。

- f

  必要なデータページ数は見積もり行数を 1 ページ当たりの平均行数で割れば良いので、
  `1,200,000 / 24 = 50,000`となる。

- g

  データ所要量は必要なページ数*ページサイズで求めることができるので、
  `50,000 * 4,000 = 200,000,000`となり、桁が百万単位なので、`200`となる。

##### (3)

- h

  暗号化するために AP を用いており、A では AP を利用してのデータの持ち出しとなっているので、暗号化したとしても効果を発揮しないので $\times$ となる。

- i

  バックアップしたデータは暗号化されているので、持ち出されても復号キーがないとデータを読み取る(理解)できないので、対策としては有効であると考えられるので $\circ$ となる。

- 有効でない場合

  C の状況はデータが盗まれた場合について考えています。基本的には暗号化しているため、AP を通さずにデータが盗まれたとしてもデータは暗号化されているので問題ない。
  しかし、AP の複合関数と複合の鍵が盗まれていた場合、AP を通さなくてもデータを復元できてしまうことが分かるので、

  `複合関数名と鍵を盗まれた場合`

  となる。

- トレードオフの事象

  暗号化することで、ページ 12 $>$ 3. 個人情報保護の強化 に　
  「 $\sim$ 各列のデータ型、データ長の定義を変更する。」と書かれており、データが変わってしまうことが分かる。
  顧客名は表 3 にもあるように非ユニーク索引が作成されているので、この暗号化により使用ができなくなるので、

  `顧客名による検索に索引を使用できないので性能が劣化する`

  となる。

#### 設問 2

##### (1)

- j

  1 番の段には外部キーを持っていないものを選択することで参照制約に反しないテーブルを選択できるので

  > 商品種別

  となる。

- k

  1 段目で選択したテーブルは既にテーブルを移動済みであるので、1 段目にあるテーブルの主キーを外部キーとしてもつテーブルも移動が可能となる。
  1 段目のテーブルの主キー以外の外部キーを持っていないテーブルを選択することができるので、

  > 運用商品

  となる。

- l

  3 段目までに選択したテーブルは既にテーブルを移動済みであるので、3 段目までにあるテーブルの主キーを外部キーとしてもつテーブルも移動が可能となる。
  3 段目までのテーブルの主キー以外の外部キーを持っていないテーブルを選択することができるので、

  > 顧客基本

  となる。

- m

  4 段目までに選択したテーブルは既にテーブルを移動済みであるので、4 段目までにあるテーブルの主キーを外部キーとしてもつテーブルも移動が可能となる。
  4 段目までのテーブルの主キー以外の外部キーを持っていないテーブルを選択することができるので、

  > 顧客詳細, 顧客口座

  となる。

- n

  5 段目までに選択したテーブルは既にテーブルを移動済みであるので、5 段目までにあるテーブルの主キーを外部キーとしてもつテーブルも移動が可能となる。
  5 段目までのテーブルの主キー以外の外部キーを持っていないテーブルを選択することができるので、

  > 取引, コンタクト履歴

  となる。

##### (2)

- o

  コンタクト履歴の行数は`576,000,000`であり、E&I なので、`576,000,000 / 10,000 + 576,000,000 / 5,000 = 57,600 + 115,200 = 172,800`秒となる。
  これを時間に直すと`48`時間となる。

- p

  コンタクト履歴の行数は`576,000,000`であり、E&I なので、`576,000,000 / 2000 = 288,000`秒となる。
  これを時間に直すと`80`時間となる。

- q

  短い方の 48 時間を採用し、毎日 4 時間移行処理を行うので`48 / 4 = 12`となるので`12`日となる。

- r

  ページ 16 $>$ 3. データ移行処理方式設計 $>$ (2) に
  「移行データ抽出に使用する"抽出範囲"テーブルを現行 DB に追加し、抽出処理日ごとに、行数が均等になるように支店コードの範囲を決めて登録することにした。」と書かれているので
  移行対象のデータであるかの判定は支店コードが移行対象であるかを調べれば良いので、

  ```SQL
  A.支店コード BETWEEN B.開始支店コード AND B.終了支店コード
  ```

  となる。

- s

  「抽出処理日ごとに」(r 参照)と書かれているので、処理を行う日がいつなのかを知る必要がある。
  ページ 18 $>$ 設問 2 $>$ (2)に「ここで、現在日付を表す予約語を CURRENT_DATE とする。」と書かれているので、

  ```sql
  B.抽出処理日 = CURRENT_DATE
  ```

  となる。

##### (3)

- t

  差分が生じる状態は既に移行した支店コードのデータが新たにデータ登録されるか移行した後に移行した元データに変更があった場合に
  差分が生じる。処理 A では条件が「登録日が抽出処理日の後である」と書かれているので、新しく登録した場合に処理であることが分かる。
  そのため、処理 B では移行したデータに変更があった場合について考えれば良い。
  移行した元データに変更があるということはもうすでにデータは移行したということなので、移行済みであるということが条件となるので、
  `登録日が抽出処理日より前である`が条件と 1 つとなる。

- u

  (t の続き)もう一つの条件はデータが変更されたということである。データの変更はページ 8 の表 1 に書かれているように
  最終更新 TS が変更した時間を記録しているので、
  `最終更新TSが抽出処理日よりも後である`がもう 1 つの条件となる。

- v

  処理 A は新しくデータを挿入するので、移行処理が速い移行方法を選択する方が良いので、
  `E&I`となる。

- w

  処理 B は既に存在するデータの変更となるので、E&I を使用することができない(主キーが重複するのでインポートできない)。そのため、`DI`となる。

#### 設問 3

##### (1)

- x

  和集合を表す SQL の処理は`UNION`である。

- y

  差集合を表す SQL の処理は`EXCEPT`である。

- z

  積集合を表す SQL の処理は`INTERSECT`である。

##### (2)

- $\textcircled{\scriptsize 1}$

  ページ 9 $>$ 3. DB サーバ更改時の実施事項 $>$ (4)に　
  「取扱商品の増加に備えて、商品コードの桁数を 4 桁から 6 桁に増やす。移行時に、現在の商品コードの前に'00'を付加する。」と書かれているので
  移行前と移行後では商品コードが異なっていることが分かる。

  そのため、

  - 原因

    商品コードの桁数の不一致

  - 修正内容

    選択リストを\*ではなく、列名をコンマで区切ったリストに変更し、現行 DB の商品コードの前に'00'を付加する演算を追加する。

  となる。

- $\textcircled{\scriptsize 2}$

  ページ 9 $>$ (4)に「データ移行時には、その月の末日のバッチ処理で削除されることが分かっているデータは、移行の対象としない。」と書かれているので、
  移行されていないデータが存在することが分かる。

  そのため、

  - 原因

    毎月末日の削除対象データの不一致

  - 修正内容

    現行 DB の SELECT 文に、案件の登録日が 10 年前の月初めより前のデータを抽出しない条件の WHERE 句を追加する。

  となる。

### 大問 2

#### (1)

![午後2 大問2 表1](/img/png/Database/database-specialist/H28/2-2-chart-1.png "午後2 大問2 表1")

- ア

  「予防保全保守契約を結んでいるか」に対して Y の場合のみ X となっているので、予防保全保守契約が関係あることが分かる。
  ページ 24 $>$ (8) $>$ $\textcircled{\scriptsize 1}$に
  「予防保全保守契約があり、予防保全対応が必要と判断した場合、予防保全対応を実施し、どの業務の判断によるものか対応付ける。」と書かれており、
  X マークがついてるのは契約を結んでいるかつ対応が必要である場合のみなので

  `予防保全対応を実施する`

  となる。

- イ

  修理対応 or 予防保全対応を行なった場合に X マークがついてる。
  ページ 23 $>$ (7) $>$ $\textcircled{\scriptsize 1}$に
  「修理が必要な場合、修理を実施し、どの業務の判断によるものか対応付ける。」と修理について書かれており、
  ページ 24 $>$ (10) $>$ $\textcircled{\scriptsize 1}$に
  「サービス班が予防保全対応・修理対応・リコール対応の記録に用いている帳票のヘッダ部分は、
  それぞれの対応によって固有の様式であるが、明細部分は共通の様式であり、共通の対応明細で記録する。」
  と書かれている。修理 or 予防保全対応を行なった場合に行うことなので、

  `対応明細を記録する`

  となる。

#### (2)

![午後2 大問2 図1](/img/png/Database/database-specialist/H28/2-2-figure-1.png "午後2 大問2 図1")
![午後2 大問2 図2](/img/png/Database/database-specialist/H28/2-2-figure-2.png "午後2 大問2 図2")

- あ

  ページ 20 $>$ 1. 顧客・自社組織 $>$ (1) $>$ $\textcircled{\scriptsize 2}$に
  「 $\sim$ 未利用地設置プラントの場合は、定期的に下草刈りをすることが多いので、下草刈り総面積を保持する。」と書かれているが、
  図 1,2 には存在しない。そのため、図 2 の住宅用プラント・産業用プラントの近くである`あ`に`未利用地設置プラント`となることが分かる。

- い

  ページ 21 $>$ 2. 品目・保守契約 $>$ (1) $>$ $\textcircled{\scriptsize 3}$に
  「製品に対応する部材、及び製品一つ当たりの対応数を表にまとめ、調べられるようにしている。この表を製品部材対応という。」と書かれているので、
  製品部材対応表というテーブルが存在していることが分かる。また、E-R 図の`い`を見ると製品と多対 1 の関係となっていることが分かるので、
  `い`が`製品部材対応`となる。

- う

  ページ 21 $>$ 2. 品目・保守契約 $>$ (1) $>$ $\textcircled{\scriptsize 5}$に
  「各号機を構成する品目について、品目ごとの構成数を記録している。」と書かれているが、品目ごとの構成数を記録したテーブルが図 2 には存在しない。
  また、E-R 図の`う`を見ると号機と多対 1 の関係となっていることが分かるので、
  `う`が`号機構成品目`となる。

- え

  ページ 22 $>$ 3. 故障現象・リコール・リコール対応枠 $>$ (1) $>$ $\textcircled{\scriptsize 2}$に
  「故障現象別に、対応に必要な品目の一覧を整備している。その一覧では、直接関連区分(当該品目が、故障の直接原因又は関節原因なのか)を有している。」と書かれているが
  故障現象と対応品目についてのテーブルが図 2 に存在しない。また、E-R 図の`え`を見ると故障現象と多対 1 の関係となることが分かるので、
  `え`が`故障現象対応品目`となる。

- お

  ページ 21 $>$ 2. 品目・保守契約 $>$ (2)に
  「 $\sim$ 保守契約は、一つ又は複数の号機を対象に結ぶ。保守契約は、後から追加されたり解約されたりすることがある。 $\sim$ 」
  と書かれており、保守契約と号機の関係が多対多の関係であることが分かる。しかし、図 2 の中には保守契約と号機の関係についてのテーブルが存在しないので
  `お`が`保守対象号機`となる。

#### (3)

- a
- b
- c
- d
- e
- f
- g
- h
- i
- j
- k
- l
- m
- n
- o
- p
- q
- r
